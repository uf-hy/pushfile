# PushFile 协作与发布规范

## 1) 沟通偏好
- 你通常使用语音输入，文本可能有口语化、省略、错别字。
- 处理需求时应先提炼真实意图，再执行，不要机械按字面理解。
- 发现“能直接修”的问题要主动修复，不要等下一句催促。

## 2) 强制开发流程（必须遵守）
1. 新建分支开发（禁止在生产容器热改）。
2. 本地自测（至少：关键接口、页面可访问、基础回归）。
3. 推送分支并创建 PR。
4. 等 CI 全绿 + AI 审核完成。
5. 代码评审通过后合并。
6. 由 GitHub Actions 执行部署（production 分支触发），禁止手工 `docker cp` 改生产。
7. 部署后做线上回归：`/manage`、`/d/{token}`、上传链路、关键图片接口。

## 3) 紧急故障处理（P0）
- 第一优先：恢复可用（回滚到最近稳定镜像）。
- 恢复后必须补 PR，把“临时修复”变成“可追踪代码变更”。
- 不允许长期保留只在容器里的“漂移代码”。

## 4) 版本号与构建时间规范
- 使用语义化版本：`major.minor.patch`
  - patch：小修复
  - minor：向后兼容的新功能
  - major：不兼容变更
- 展示格式：
  - 版本：`vX.Y.Z`
  - 构建时间：`MM-DD HH:mm`
- 不显示时区后缀，不使用“local/dev”作为对外展示文案。

## 5) 发布与回滚原则
- 生产镜像必须来自 GHCR（由 Actions 构建产物）。
- 部署使用 `deploy.yml`；回滚使用 `rollback.yml`。
- 若流程被绕过，视为发布事故，必须补齐 PR 与记录。
