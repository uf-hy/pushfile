*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
:root{--bg:#f2f2f7;--card:#fff;--text:#1d1d1f;--sub:#8e8e93;--line:#c6c6c8;--accent:#007aff;--danger:#ff3b30;--green:#34c759;--r:14px}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",system-ui,sans-serif;-webkit-font-smoothing:antialiased;padding-bottom:env(safe-area-inset-bottom)}
.page{max-width:600px;margin:0 auto;padding:12px 16px 40px;padding-top:max(12px,env(safe-area-inset-top))}
.nav{display:flex;align-items:center;justify-content:center;padding:8px 0 16px;position:relative}
.nav h1{font-size:17px;font-weight:600}
.nav .badge{position:absolute;right:0;top:50%;transform:translateY(-50%);font-size:12px;color:var(--sub);padding:6px 12px;background:var(--card);border-radius:20px}
.nav .badge-left{left:0;right:auto}
.nav-btn{position:absolute;right:92px;top:50%;transform:translateY(-50%);border:none;background:var(--card);color:var(--text);padding:6px 10px;border-radius:10px;font-size:12px;cursor:pointer}
.build-meta{font-size:11px;color:var(--sub);text-align:center;margin-top:-10px;margin-bottom:12px}
.group{margin-bottom:24px}
.group-label{font-size:13px;font-weight:400;color:var(--sub);text-transform:uppercase;letter-spacing:.5px;padding:0 16px 8px}
.group-box{background:var(--card);border-radius:var(--r);overflow:hidden}
.row{display:flex;align-items:center;padding:12px 16px;min-height:48px;gap:12px;border-bottom:1px solid var(--bg)}
.row:last-child{border-bottom:none}
.row-stack{flex-direction:column;align-items:stretch;gap:8px}
.row input[type=text],.row input[type=password]{flex:1;border:none;background:transparent;font-size:16px;color:var(--text);outline:none;min-width:0;padding:0}
.row input::placeholder{color:var(--line)}
.row-label{font-size:15px;color:var(--text);white-space:nowrap;width:64px;flex-shrink:0}
.row-value{flex:1;text-align:right;color:var(--sub);font-size:15px;overflow:hidden;text-overflow:ellipsis}
.row-chevron{color:var(--line);font-size:18px}
.row-tap{cursor:pointer;-webkit-user-select:none;user-select:none;transition:background .1s}
.row-tap:active{background:var(--bg)}
.btn-row{display:flex;gap:8px;width:100%}
.btn{display:flex;align-items:center;justify-content:center;gap:6px;padding:12px 20px;border-radius:var(--r);font-size:15px;font-weight:500;border:none;cursor:pointer;width:100%;min-height:48px;transition:opacity .15s}
.btn:active{opacity:.7}
.btn-blue{background:var(--accent);color:#fff}
.btn-gray{background:#e5e5ea;color:var(--text)}
.btn-red{background:var(--danger);color:#fff}
.btn-sm{padding:8px 14px;font-size:14px;min-height:36px;width:auto;border-radius:10px}
.btn-link{background:none;color:var(--accent);padding:0;min-height:auto;width:auto;font-size:15px}
.chips{display:flex;gap:8px;overflow-x:auto;padding:4px 0;-webkit-overflow-scrolling:touch;scrollbar-width:none}
.chips::-webkit-scrollbar{display:none}
.chip{flex-shrink:0;padding:8px 16px;background:var(--card);border:2px solid transparent;border-radius:20px;font-size:14px;font-weight:500;cursor:pointer;transition:all .15s;display:flex;align-items:center;gap:6px}
.chip:active{opacity:.7}
.chip.active{border-color:var(--accent);color:var(--accent);background:rgba(0,122,255,.06)}
.chip .cnt{font-size:12px;color:var(--sub);background:var(--bg);padding:1px 7px;border-radius:99px}
.chip.active .cnt{background:rgba(0,122,255,.1);color:var(--accent)}
.share{display:flex;align-items:center;gap:10px;padding:12px 14px;background:rgba(0,122,255,.06);border-radius:var(--r);margin-bottom:16px}
.share-url{flex:1;font-size:14px;color:var(--accent);word-break:break-all;line-height:1.4}
.share-copy{flex-shrink:0}
.upload-zone{border:2px dashed var(--line);border-radius:var(--r);padding:24px 16px;text-align:center;transition:all .2s;cursor:pointer}
.upload-zone:active,.upload-zone.dragover{border-color:var(--accent);background:rgba(0,122,255,.04)}
.upload-zone .icon{font-size:36px;margin-bottom:8px}
.upload-zone p{color:var(--sub);font-size:14px}
.upload-zone small{color:var(--line);font-size:12px}
.upload-prog{margin-top:10px;display:none}
.upload-bar{height:4px;background:var(--bg);border-radius:99px;overflow:hidden}
.upload-fill{height:100%;width:0%;background:var(--accent);border-radius:99px;transition:width .15s}
.upload-txt{font-size:12px;color:var(--sub);text-align:center;margin-top:4px}
.photos{display:grid;grid-template-columns:repeat(3,1fr);gap:2px;border-radius:var(--r);overflow:hidden;background:var(--bg)}
.photo{position:relative;aspect-ratio:1;background:#f0f0f0;overflow:hidden}
.photo img{width:100%;height:100%;object-fit:cover;display:block}
.photo-sel{position:absolute;top:8px;left:8px;width:24px;height:24px;border-radius:50%;border:2px solid #fff;background:rgba(0,0,0,.3);display:flex;align-items:center;justify-content:center;color:#fff;font-size:12px;cursor:pointer;z-index:2;transition:all .15s;box-shadow:0 1px 3px rgba(0,0,0,.3)}
.photo-sel.on{background:var(--accent);border-color:var(--accent)}
.photo-name{position:absolute;bottom:0;left:0;right:0;padding:4px 8px;background:linear-gradient(transparent,rgba(0,0,0,.7));color:#fff;font-size:10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.photo.dragging{opacity:.4}
.sheet-bg{position:fixed;inset:0;background:rgba(0,0,0,.4);z-index:100;display:none;align-items:flex-end;justify-content:center;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}
.sheet-bg.show{display:flex}
.sheet{width:100%;max-width:500px;background:var(--card);border-radius:14px 14px 0 0;padding:8px 0 max(8px,env(safe-area-inset-bottom));animation:sheetUp .25s ease}
@keyframes sheetUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.sheet-handle{width:36px;height:5px;background:var(--line);border-radius:99px;margin:6px auto 8px}
.sheet-item{display:flex;align-items:center;gap:12px;padding:14px 20px;font-size:16px;cursor:pointer;transition:background .1s}
.sheet-item:active{background:var(--bg)}
.sheet-item.danger{color:var(--danger)}
.sheet-sep{height:1px;background:var(--bg);margin:4px 0}
.sheet-cancel{text-align:center;padding:14px;font-size:16px;font-weight:500;color:var(--accent);cursor:pointer}
.sheet-cancel:active{background:var(--bg)}
.batch{position:fixed;bottom:0;left:0;right:0;background:var(--card);border-top:1px solid var(--bg);padding:10px 16px max(10px,env(safe-area-inset-bottom));display:none;gap:8px;align-items:center;z-index:50;flex-wrap:wrap}
.batch.show{display:flex}
.batch-count{font-size:14px;font-weight:600;color:var(--accent);margin-right:auto}
.toast{position:fixed;top:max(60px,env(safe-area-inset-top,60px));left:50%;transform:translateX(-50%) translateY(-80px);background:var(--text);color:var(--card);padding:10px 20px;border-radius:20px;font-size:14px;z-index:500;transition:transform .3s;pointer-events:none;white-space:nowrap}
.toast.show{transform:translateX(-50%) translateY(0)}
.empty{text-align:center;padding:40px 16px;color:var(--sub)}
.empty .icon{font-size:48px;margin-bottom:8px}
.steps{display:flex;flex-direction:column;gap:0;padding:0}
.step{display:flex;gap:14px;align-items:flex-start;padding:14px 16px;border-bottom:1px solid var(--bg)}
.step:last-child{border-bottom:none}
.step-num{width:28px;height:28px;border-radius:50%;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:600;flex-shrink:0;margin-top:1px}
.step-text{flex:1;min-width:0}
.step-text b{display:block;font-size:15px;font-weight:500;margin-bottom:3px;line-height:1.3}
.step-text span{color:var(--sub);font-size:13px;line-height:1.4;display:block}
@media(prefers-color-scheme:dark){
  :root{--bg:#000;--card:#1c1c1e;--text:#f5f5f7;--sub:#8e8e93;--line:#38383a}
  .chip{background:#2c2c2e}
  .chip .cnt{background:#3a3a3c}
  .photo{background:#111}
  .share{background:rgba(0,122,255,.12)}
  .btn-gray{background:#2c2c2e;color:#f5f5f7}
  .upload-zone{border-color:#444}
  .sheet{background:#2c2c2e}
  .tree-item:active{background:#2c2c2e}
  .tree-item.active{background:rgba(0,122,255,.15)}
}
.tree{margin:0;padding:0;list-style:none}
.tree .tree{padding-left:20px}
.tree-item{display:flex;align-items:center;gap:10px;padding:10px 14px;cursor:pointer;border-bottom:1px solid var(--bg);transition:background .1s;min-height:44px}
.tree-item:active{background:var(--bg)}
.tree-item.active{background:rgba(0,122,255,.08)}
.tree-icon{font-size:18px;flex-shrink:0;width:24px;text-align:center}
.tree-name{flex:1;font-size:15px;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.tree-count{font-size:12px;color:var(--sub);background:var(--bg);padding:2px 8px;border-radius:99px;flex-shrink:0}
.tree-views{font-size:11px;color:var(--accent);padding:2px 6px;flex-shrink:0;opacity:.7}
.tree-arrow{font-size:12px;color:var(--sub);transition:transform .2s;flex-shrink:0}
.tree-arrow.open{transform:rotate(90deg)}
.zip-zone{border:2px dashed var(--line);border-radius:var(--r);padding:20px 16px;text-align:center;cursor:pointer;transition:all .2s;margin-bottom:16px}
.zip-zone:active,.zip-zone.dragover{border-color:var(--accent);background:rgba(0,122,255,.04)}
.zip-zone p{color:var(--sub);font-size:14px;margin:4px 0}
.import-flag small{color:var(--green);font-weight:600}
.zip-actions{display:flex;justify-content:center;margin-top:10px}
.zip-btn{min-width:120px}
.import-trigger{margin-top:10px}
.zip-prog{margin-top:8px;display:none}
.zip-bar{height:4px;background:var(--bg);border-radius:99px;overflow:hidden}
.zip-fill{height:100%;width:0%;background:var(--green);border-radius:99px;transition:width .3s}
.zip-txt{font-size:12px;color:var(--sub);text-align:center;margin-top:4px}
.breadcrumb{display:flex;align-items:center;gap:4px;padding:8px 0;font-size:14px;color:var(--sub);flex-wrap:wrap;margin-bottom:8px}
.breadcrumb span{cursor:pointer;color:var(--accent)}
.breadcrumb span:hover{text-decoration:underline}
.modal-bg{position:fixed;inset:0;z-index:120;display:none;align-items:flex-end;justify-content:center;background:rgba(0,0,0,.45);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}
.modal-bg.show{display:flex}
.modal-card{width:100%;max-width:560px;background:var(--card);border-radius:16px 16px 0 0;padding:16px 16px max(16px,env(safe-area-inset-bottom));box-shadow:0 -12px 30px rgba(0,0,0,.15)}
.import-meta{font-size:12px;color:var(--sub)}
.import-source{font-size:15px;font-weight:500;word-break:break-all}
.import-row-head{display:flex;justify-content:space-between;align-items:center}
.import-tip{font-size:12px;color:var(--sub);line-height:1.4}
.breadcrumb .sep{color:var(--line);cursor:default}
.ana-cards{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px}
.ana-card{background:var(--card);border-radius:10px;padding:10px}
.ana-num{font-size:18px;font-weight:700}
.ana-lbl{font-size:12px;color:var(--sub)}
